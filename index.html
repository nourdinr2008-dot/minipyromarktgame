<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Pyromarkt Mini App</title>
  <style>
    /* General Reset */
    * {
      margin: 0; padding: 0; box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #111, #333);
      color: #fff;
      overflow: hidden;
    }

    /* Splash Screen */
    #splash {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      background: #111;
      display: flex; align-items: center; justify-content: center;
      flex-direction: column;
    }

    #splash img {
      width: 200px;
      margin-bottom: 20px;
    }

    #splash button {
      background: #e25822;
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 18px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s;
    }
    
    #splash button:hover {
      background: #f06f36;
    }

    /* Game Info HUD */
    #hud {
      display: none;
      position: absolute;
      top: 0; left: 0; width: 100%;
      padding: 10px;
      display: flex; justify-content: space-between; align-items: center;
      background: rgba(0, 0, 0, 0.6);
      color: #fff;
      font-size: 14px;
      z-index: 10;
    }

    /* Left side of HUD */
    #hud .stats span { margin-right: 20px; }

    /* Small watermark logo */
    #hud img.watermark {
      width: 50px;
      opacity: 0.6;
    }
  </style>
</head>
<body>

  <!-- Splash Screen -->
  <div id="splash">
    <img src="logo.png" alt="Pyromarkt Logo">
    <button id="startButton">ENTER PORTAL</button>
  </div>

  <!-- HUD -->
  <div id="hud">
    <div class="stats">
      <span>Coins: <b id="coins">0</b></span>
      <span>Items: <b id="items">0</b></span>
      <span>Score: <b id="score">0</b></span>
      <span>ðŸ”“ Unlock Progress: <b id="unlock-progress">0%</b></span>
    </div>
    <img src="logo.png" alt="Watermark Logo" class="watermark">
  </div>

  <script>
    /* BOT INTEGRATION NOTES:
     * You will need to implement an HTTP endpoint in your existing bot:
     *  - POST https://YOUR_BOT_BACKEND_DOMAIN/api/createInvoice
     *    Request: { productId: "pyromarkt_premium" }
     *    Response: { invoice_link: "https://t.me/$invoice?..." }
     * 
     * To integrate:
     * - Set Menu Button URL in your bot to the GitHub Pages link for this Mini App.
     * - Handle `start=premium_success` and `start=buy_premium` for deep links.
     */

    /* Config: Easy to update */
    const PREMIUM_PRODUCT_ID = "pyromarkt_premium";
    const STARS_PRICE = 500; // Telegram Stars price for "Premium Access"
    const BOT_USERNAME = "@YOUR_BOT_USERNAME"; // Replace with your bot username in Telegram

    // Game variables
    let coins = 0;
    let items = 0;
    let score = 0;
    let unlockProgress = 0;

    /* Initialize Game */
    const startButton = document.getElementById("startButton");
    const splash = document.getElementById("splash");
    const hud = document.getElementById("hud");

    startButton.addEventListener("click", () => {
      splash.style.display = "none"; // Hide splash screen
      hud.style.display = "flex";  // Show HUD
      initGame();
    });

    function initGame() {
      // Setup initial game loop (e.g., key detection, map rendering)
      console.log("Game Starting...");
    }

    // Simulate a "Buy Premium" button click workflow for stars invoice creation
    function buyPremiumAccess() {
      // Placeholder HTTP request to your bot to generate invoice link
      fetch("https://YOUR_BOT_BACKEND_DOMAIN/api/createInvoice", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ productId: PREMIUM_PRODUCT_ID })
      })
        .then(response => response.json())
        .then(data => {
          if (data.invoice_link) {
            Telegram.WebApp.openInvoice(data.invoice_link);
          } else {
            alert("Invoice creation failed. Please contact support.");
          }
        })
        .catch(err => {
          console.error("Error creating invoice:", err);
          alert("Failed to request invoice. Try again later or contact support.");
        });
    }

    // Fallback Deep Link for Manual Payment
    function manualPaymentFallback() {
      const manualLink = `https://t.me/${BOT_USERNAME}?start=buy_premium`;
      window.open(manualLink, "_blank"); // Open fallback in Telegram
    }
  </script>
</body>
</html>